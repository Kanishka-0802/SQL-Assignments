Assignment -3


1. Write a query to display the custid ,name, age, orderid,orderdate for product books or cd, sort data by name in descending order 

select c.custid ,c.custname,c.age , o.orderid,o.orderdate  from  customers c inner join orders o on c.custid=o.custid  where o.products in ('Books','cd') order by c.custname desc 

 
2. Write a SQL statement to find the list of customers who live in the same city as ajay, and display custid , custname , price (price > 500) 

 --2--

select  c.custid,c.custname , c.caddress, o.price from customers c  inner join orders o on c.custid=o.custid where c.caddress = (select caddress from customers where custname='Ajay')  and o.price>500
 
3. Write a query to find the name of customers along with order details who purchased   more than two products 

--3--
select c.custid, c.custname, o.orderid, o.orderdate, o.productid, o.qty, o.price from customers_1 c
inner join orders_1 o on c.custid = o.custid where c.custid in (select custid from orders_1 group by custid having count(productid) > 2)

 
4. A discount of 20% has been announced to all customers who resides in Bangalore . display custid , custname , orderid  and discount price  
 
--4--

select c.custid,c.custname,o.orderid, o.price * 0.8 as discountprice from customers c inner join  orders o on c.custid=o.custid where c.caddress ='Banglore'

 
5. write a query to join three tables (create products table for the same) 

--5--

select c.custid, c.custname, c.age,o.orderid, o.orderdate, o.qty, o.price,p.productname, p.category from customers_1 c
inner join orders_1 o on c.custid = o.custid inner join products_1 p on o.productid = p.productid
 
6. update price by 5% from orders table for customers who resides in pune and chennai 

	
--6--
update o set o.price = o.price * 1.05 from orders_1 o inner join customers_1 c on o.custid = c.custid where c.caddress in ('Pune', 'Chennai')


--7--

7. create a report in following format 
 
Custidord Custname Product Price orderdate 
cid:100-ordid:1     
 
 
1. Custname should be uppercase 
2. Display only first 3 character of product 
3.  The report should be of December 2000 



select concat('cid:', custid, '-ordid:', orderid) AS Custidord,
left(qty, 3) AS Products,price,orderdate from orders_1 where orderdate between '2000-12-01' and '2000-12-31'


Validations :

I. Student Roll Number should be  autogenerated as (100,200,300…). 
Alter Command 

a. DOB cannot be greater then current date 

--a--

alter table students add constraint tocheck_dob check (DOB <= getdate())

b. Class should be between 1 - 10

--b--
alter table students add constraint tocheck_class check (Class between 1 and 10)


2)

Create Table Stock 
StockId 
MinStockLvl 
MaxStockLvl 
 
Alter Command 
The MaxStockLvl should be Greater than MinStockLvl. 
Stock id should be following format 
stc-11-aaa 
Start with 3 alphabets following by – followed by 2 digit followed by – and 
ending with 3 alphabets .

alter table  Stock add constraint chk_stock_levels check (MaxStockLvl > MinStockLvl)

alter table  Stock add constraint chk_stockid check (StockId like '[A-Za-z][A-Za-z][A-Za-z]-[0-9][0-9]-[A-Za-z][A-Za-z][A-Za-z]')

insert into Stock values ('stc-11-aaa', 10, 50)
insert into Stock values ('abc-22-xyz', 15, 10)
insert into Stock values ('stock-11-aa', 5, 20)




3)
Create Table purchase 
 
Productid 
PurchaseDate 
Serialno 
Price 
Qty  
Total 
 
• The default value for purchase date should be the system date. 
• Serialno  should be a unique  
• Total to be autogenerated 
• Create a rule  qty should be greater than 1 
• Create a rule where price should be between 1000 and  7000


alter table  Purchase add constraint df_PurchaseDate default (getdate()) for PurchaseDate

alter table  Purchase add constraint uq_SerialNo unique (SerialNo)
alter table Purchase drop column Total
alter table Purchase add Total as (Price * Qty)

alter table  Purchase add constraint chk_qty check(Qty > 1)


alter table Purchase add constraint chk_price check (Price between 1000 and 7000)


